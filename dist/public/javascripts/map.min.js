function initialize(){var e=new google.maps.LatLng(41.5895,-93.612),a=[{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#cccccc"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#000000"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{hue:0},{saturation:100},{lightness:100}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#D1AB38"},{lightness:-35}]}],o={zoom:15,maxZoom:19,minZoom:15,center:e,backgroundColor:"#FFFFFF",styles:a,mapTypeControl:!1},r=document.getElementById("map-canvas");map=new google.maps.Map(r,o);var t={location:e,radius:250,types:storeTypes},s={location:e,radius:200,types:["store"]},l={location:e,radius:300,types:["restaurant","cafe"]},n={location:e,radius:450,types:["cafe","bar","night_club","lounge"]};NEIGHBORHOOD.addRequest(0,t,storeCallback),NEIGHBORHOOD.addRequest(0,s,storeCallback),NEIGHBORHOOD.addRequest(1,n,drinkCallback),NEIGHBORHOOD.addRequest(2,l,diningCallback),PLACE.addCustomCategory(0,storeTypes,uncategorizedStoreInclude),kmlLayer=new google.maps.FusionTablesLayer({query:{select:"geometry",from:"1400IQGlzH5dGWJsruolfKlOXFXjUkJvxUXPD8QCW",where:"'NHNAME' = 'Historic East Village'"},styles:[{polygonOptions:{fillOpacity:.1,strokeColor:"#CC3333"}}]}),NEIGHBORHOOD.draw(kmlLayer,map),placesService=new google.maps.places.PlacesService(map),infowindow=new google.maps.InfoWindow,google.maps.event.addListener(map,"zoom_changed",setNeighborhood)}function storeCallback(e,a,o){callback(e,a,o,storeMarkers)}function diningCallback(e,a,o){callback(e,a,o,diningMarkers)}function drinkCallback(e,a,o){callback(e,a,o,drinkMarkers)}function serviceCallback(e,a,o){callback(e,a,o,serviceMarkers)}function callback(e,a,o,r){var t=0;if(a==google.maps.places.PlacesServiceStatus.OK){var s=document.getElementById("select-cat");if(s)var l=s.value;createMarkers(e,r,l),t+=e.length,o.hasNextPage?o.nextPage():(console.log(t),s&&NEIGHBORHOOD.addLayer(l,r),createInfoWindows(r))}}function createMarkers(e,a,o){for(var r=0;r<e.length;r++){var t=e[r],s=PLACE.createMarker(map,t,o);if(s&&s.getPosition()){var l=PLACE.getMarkerUniqueId(s.getPosition().lat(),s.getPosition().lng());a.push({markerId:l,marker:s,reference:t.reference})}}}function createInfoWindows(e){for(var a=0;a<e.length;a++)INFOWINDOW.createInfoWindow(e[a],placesService,infowindow,map)}function changeCategory(e){e.className=e.options[e.selectedIndex].innerHTML.toLowerCase(),infowindow.close(),NEIGHBORHOOD.switchLayer(e.value,map,placesService)}function setNeighborhood(){map.getZoom()<=15?kmlLayer.setMap(map):kmlLayer.setMap(null)}var map,placesService,resultList,infowindow,kmlLayer,uncategorizedStoreInclude=["Bargain Basket","Liberty Gifts","Hammer Pharmacy","Ephemera","Found Things","Jett and Monkey's Dog Shoppe","Subsect Skateboard Shop","Vanity & Glamour Cosmetics / VGCosmetic Makeup Artists","Porch Light","Green Goods For The Home","Metroretro"],storeTypes=["furniture_store","clothing_store","bicycle_store","home_goods_store","jewelry_store","pet_store","shoe_store","grocery_or_supermarket","art_gallery","book_store","thrift_store"],storeMarkers=[],diningMarkers=[],drinkMarkers=[],serviceMarkers=[];google.maps.event.addDomListener(window,"load",initialize);