function initialize(){var e=new google.maps.LatLng(41.5895,-93.612),a=[{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#cccccc"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#000000"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{hue:0},{saturation:100},{lightness:100}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels.text.fill",stylers:[{color:"#D1AB38"},{lightness:-35}]}],o={zoom:15,maxZoom:19,minZoom:15,center:e,backgroundColor:"#FFFFFF",styles:a,mapTypeControl:!1},n=document.getElementById("map-canvas");map=new google.maps.Map(n,o);var r=[new google.maps.LatLng(41.59533840000001,-93.6163902),new google.maps.LatLng(41.5945761,-93.6168087),new google.maps.LatLng(41.5940947,-93.6171305),new google.maps.LatLng(41.59387,-93.6171734),new google.maps.LatLng(41.5936855,-93.61730220000001),new google.maps.LatLng(41.5924899,-93.6178815),new google.maps.LatLng(41.5919042,-93.6179888),new google.maps.LatLng(41.5916554,-93.6179459),new google.maps.LatLng(41.5892482,-93.6172056),new google.maps.LatLng(41.5891519,-93.617152),new google.maps.LatLng(41.5889352,-93.6171198),new google.maps.LatLng(41.5887266,-93.6169696),new google.maps.LatLng(41.587892,-93.616755),new google.maps.LatLng(41.5860464,-93.6160254),new google.maps.LatLng(41.585934,-93.6158538),new google.maps.LatLng(41.5848587,-93.6155105),new google.maps.LatLng(41.5828043,-93.6147594),new google.maps.LatLng(41.582659899999996,-93.6145878),new google.maps.LatLng(41.5821302,-93.6142445),new google.maps.LatLng(41.5819215,-93.6139441),new google.maps.LatLng(41.5810066,-93.612442),new google.maps.LatLng(41.5802844,-93.6110044),new google.maps.LatLng(41.5792089,-93.6082578),new google.maps.LatLng(41.5787435,-93.6065626),new google.maps.LatLng(41.5784706,-93.6062407),new google.maps.LatLng(41.57845449999999,-93.6058116),new google.maps.LatLng(41.577860599999994,-93.604331),new google.maps.LatLng(41.5775717,-93.6033225),new google.maps.LatLng(41.57668890000001,-93.600812),new google.maps.LatLng(41.5766889,-93.6004901),new google.maps.LatLng(41.5763999,-93.5994601),new google.maps.LatLng(41.5759986,-93.5971427),new google.maps.LatLng(41.59018700000001,-93.5969925),new google.maps.LatLng(41.59581980000001,-93.5989666),new google.maps.LatLng(41.5949532,-93.6032796),new google.maps.LatLng(41.59484090000001,-93.6040306),new google.maps.LatLng(41.5947767,-93.60467430000001),new google.maps.LatLng(41.5947446,-93.6054683),new google.maps.LatLng(41.5947767,-93.6065197),new google.maps.LatLng(41.59533840000001,-93.6163902)];neighborhoodPolygon=new google.maps.Polygon({path:r,strokeOpacity:0,fillColor:"#FCEDBD",fillOpacity:.35,map:map}),requestCategorizedStore={location:e,radius:250,types:storeTypes},requestUncategorizedStore={location:e,radius:200,types:["store"]},requestDining={location:e,radius:300,types:["restaurant","cafe"]},requestDrink={location:e,radius:450,types:["cafe","bar","night_club","lounge"]},placesService=new google.maps.places.PlacesService(map),infowindow=new google.maps.InfoWindow,google.maps.event.addListener(map,"zoom_changed",setNeighborhood)}function makeMarker(e,a){var o={path:google.maps.SymbolPath.CIRCLE,scale:6,fillColor:e,fillOpacity:1,strokeColor:"white",strokeOpacity:1,strokeWeight:1};return new google.maps.Marker({icon:o,map:map,position:a})}function storeCallback(e,a,o){callback(e,a,o,storeMarkers)}function diningCallback(e,a,o){callback(e,a,o,diningMarkers)}function drinkCallback(e,a,o){callback(e,a,o,drinkMarkers)}function serviceCallback(e,a,o){callback(e,a,o,serviceMarkers)}function callback(e,a,o,n){a==google.maps.places.PlacesServiceStatus.OK&&(createMarkers(e,n),resultsCount+=e.length,o.hasNextPage?o.nextPage():(console.log(resultsCount),createInfoWindows(n)))}function createMarkers(e,a){for(var o=0;o<e.length;o++){var n=e[o],r=createMarker(n);if(r&&r.getPosition()){var t=getMarkerUniqueId(r.getPosition().lat(),r.getPosition().lng());a.push({markerId:t,marker:r,reference:n.reference})}}}function createMarker(e){var a,o=e.geometry.location,n=document.getElementById("select-cat").value;if("shop"==n){var r=e.types.some(function(e){return storeTypes.indexOf(e)>-1}),t=uncategorizedStoreInclude.indexOf(e.name)>-1;(r||t)&&(a=makeMarker("#40AD48",o,e))}return"dine"==n&&(a=makeMarker("#EC008B",o,e)),"drink"==n&&(a=makeMarker("#00ADEF",o,e)),a}function createInfoWindows(e){for(var a=0;a<e.length;a++)createInfoWindow(e[a].marker,e[a].reference)}function createInfoWindow(e){google.maps.event.addListener(e,"click",function(){var a=document.getElementById("select-cat").value,o=getMarkerUniqueId(e.getPosition().lat(),e.getPosition().lng());if(storeMarkers.length>0&&"shop"==a)var n=storeMarkers.filter(function(e){return e.markerId==o});if(diningMarkers.length>0&&"dine"==a)var n=diningMarkers.filter(function(e){return e.markerId==o});if(drinkMarkers.length>0&&"drink"==a)var n=drinkMarkers.filter(function(e){return e.markerId==o});var r={reference:n[0].reference};placesService.getDetails(r,function(e,a){var o='<a href="#" id="place-detail-pane-close" class="button">X</a>';if(a==google.maps.places.PlacesServiceStatus.OK?o=o+'<div class="h-card"><p class="p-name"><strong>'+e.name+'</strong></p><div class="p-tel tel"><dt>Phone</dt><dd><a class="value phone" href="tel:'+e.formatted_phone_number+'">'+e.formatted_phone_number+'</a></dd></div><p class="p-adr h-adr"><div class="p-street-address street-address" >'+e.address_components[0].short_name+" "+e.address_components[1].short_name+"</div></p></div>":(console.warn("not ok place with reference"+n[0].reference),o+='<p class="p-name"><strong>place detail could not be retrieved </strong></p>'),Modernizr.csstransitions&&Modernizr.csstransforms){var r=document.getElementById("place-detail-pane");r&&(r.innerHTML=o)}else infowindow.setContent(o),infowindow.open(map,n[0].marker)});var t=document.getElementById("trigger-detail-pane");t.click||addClickEvent(t),t.click()})}function changeCategory(e){e.className=e.value,hideMarkers(e.value),infowindow.close();var a=document.getElementById("place-detail-pane-close");a&&a.click(),map.getZoom()<17&&map.setZoom(17),"shop"==e.value&&(storeMarkers.length>0?showMarkers(storeMarkers):(placesService.nearbySearch(requestCategorizedStore,storeCallback),placesService.nearbySearch(requestUncategorizedStore,storeCallback))),"dine"==e.value&&(diningMarkers.length>0?showMarkers(diningMarkers):placesService.nearbySearch(requestDining,diningCallback)),"drink"==e.value&&(drinkMarkers.length>0?showMarkers(drinkMarkers):placesService.nearbySearch(requestDrink,drinkCallback))}function hideMarkers(e){"shop"==e&&(diningMarkers.forEach(function(e){e.marker.setVisible(!1)}),drinkMarkers.forEach(function(e){e.marker.setVisible(!1)})),"dine"==e&&(storeMarkers.forEach(function(e){e.marker.setVisible(!1)}),drinkMarkers.forEach(function(e){e.marker.setVisible(!1)})),"drink"==e&&(storeMarkers.forEach(function(e){e.marker.setVisible(!1)}),diningMarkers.forEach(function(e){e.marker.setVisible(!1)}))}function addClickEvent(e){"undefined"==typeof e||e.click||(e.click=function(){var e=this.ownerDocument.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,this.ownerDocument.defaultView,1,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(e)})}function showMarkers(e){e.forEach(function(e){e.marker.setVisible(!0)})}function setNeighborhood(){map.getZoom()<=15?neighborhoodPolygon.setMap(map):neighborhoodPolygon.setMap(null)}var map,placesService,neighborhoodPolygon,resultList,infowindow,requestCategorizedStore,requestUncategorizedStore,requestDining,requestDrink,resultsCount=0,uncategorizedStoreInclude=["Bargain Basket","Liberty Gifts","Hammer Pharmacy","Ephemera","Found Things","Jett and Monkey's Dog Shoppe","Subsect Skateboard Shop","Vanity & Glamour Cosmetics / VGCosmetic Makeup Artists","Porch Light","Green Goods For The Home","Metroretro"],storeTypes=["furniture_store","clothing_store","bicycle_store","home_goods_store","jewelry_store","pet_store","shoe_store","grocery_or_supermarket","art_gallery","book_store","thrift_store"],storeMarkers=[],diningMarkers=[],drinkMarkers=[],serviceMarkers=[],getMarkerUniqueId=function(e,a){return e+"_"+a};google.maps.event.addDomListener(window,"load",initialize);